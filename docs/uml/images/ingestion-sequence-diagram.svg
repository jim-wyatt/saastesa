<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="658px" preserveAspectRatio="none" style="width:1388px;height:658px;background:#FFFFFF;" version="1.1" viewBox="0 0 1388 658" width="1388px" zoomAndPan="magnify"><title>SaaS TESA - Signal Ingestion Sequence</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="309.3125" x="540.9119" y="27.9951">SaaS TESA - Signal Ingestion Sequence</text><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="300.5347" x="659.4053" y="281.2578"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="runner" id="part1-lifeline"><g><title>Agent Runner</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="52.3027" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="56" x2="56" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="provider" id="part2-lifeline"><g><title>MockThreatSignalProvider</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="212.3608" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="215.6055" x2="215.6055" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="sdk" id="part3-lifeline"><g><title>TESAApiClient</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="377.4888" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="381.1162" x2="381.1162" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="api" id="part4-lifeline"><g><title>FastAPI .api.v1.signals</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="551.4077" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="554.6987" x2="554.6987" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="analyze" id="part5-lifeline"><g><title>analyze_signals..</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="732.8042" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="736.4053" x2="736.4053" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="score" id="part6-lifeline"><g><title>build_finding..</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="888.6514" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="892.3628" x2="892.3628" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part7" data-qualified-name="store" id="part7-lifeline"><g><title>SQLAlchemyFindingStore</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="1051.4106" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1054.9399" x2="1054.9399" y1="118.5938" y2="577.5859"/></g></g><g class="participant-lifeline" data-entity-uid="part8" data-qualified-name="db" id="part8-lifeline"><g><title>SQLite.PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="458.9922" width="8" x="1314.5522" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1317.9683" x2="1317.9683" y1="118.5938" y2="577.5859"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="runner" id="part1-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.6055" x="5" y="115.292">Agent Runner</text><ellipse cx="56.3027" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M56.3027,58.7969 L56.3027,85.7969 M43.3027,66.7969 L69.3027,66.7969 M56.3027,85.7969 L43.3027,100.7969 M56.3027,85.7969 L69.3027,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="runner" id="part1-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.6055" x="5" y="589.5811">Agent Runner</text><ellipse cx="56.3027" cy="601.3828" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M56.3027,609.3828 L56.3027,636.3828 M43.3027,617.3828 L69.3027,617.3828 M56.3027,636.3828 L43.3027,651.3828 M56.3027,636.3828 L69.3027,651.3828" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="provider" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197.5107" x="117.6055" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183.5107" x="124.6055" y="107.292">MockThreatSignalProvider</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="provider" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197.5107" x="117.6055" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183.5107" x="124.6055" y="596.5811">MockThreatSignalProvider</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="sdk" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.7451" x="325.1162" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.7451" x="332.1162" y="107.292">TESAApiClient</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="sdk" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.7451" x="325.1162" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.7451" x="332.1162" y="596.5811">TESAApiClient</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="api" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.418" x="469.6987" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157.418" x="476.6987" y="107.292">FastAPI /api/v1/signals</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="api" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.418" x="469.6987" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157.418" x="476.6987" y="596.5811">FastAPI /api/v1/signals</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="analyze" id="part5-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.7979" x="669.4053" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.7979" x="676.4053" y="107.292">analyze_signals()</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="analyze" id="part5-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.7979" x="669.4053" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.7979" x="676.4053" y="596.5811">analyze_signals()</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="score" id="part6-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.5771" x="835.3628" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.5771" x="842.3628" y="107.292">build_finding()</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="score" id="part6-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.5771" x="835.3628" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.5771" x="842.3628" y="596.5811">build_finding()</text></g><g class="participant participant-head" data-entity-uid="part7" data-qualified-name="store" id="part7-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="190.9414" x="959.9399" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176.9414" x="966.9399" y="107.292">SQLAlchemyFindingStore</text></g><g class="participant participant-tail" data-entity-uid="part7" data-qualified-name="store" id="part7-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="190.9414" x="959.9399" y="576.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176.9414" x="966.9399" y="596.5811">SQLAlchemyFindingStore</text></g><g class="participant participant-head" data-entity-uid="part8" data-qualified-name="db" id="part8-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.168" x="1249.9683" y="115.292">SQLite/PostgreSQL</text><path d="M1300.5522,66.2969 C1300.5522,56.2969 1318.5522,56.2969 1318.5522,56.2969 C1318.5522,56.2969 1336.5522,56.2969 1336.5522,66.2969 L1336.5522,92.2969 C1336.5522,102.2969 1318.5522,102.2969 1318.5522,102.2969 C1318.5522,102.2969 1300.5522,102.2969 1300.5522,92.2969 L1300.5522,66.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1300.5522,66.2969 C1300.5522,76.2969 1318.5522,76.2969 1318.5522,76.2969 C1318.5522,76.2969 1336.5522,76.2969 1336.5522,66.2969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part8" data-qualified-name="db" id="part8-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.168" x="1249.9683" y="589.5811">SQLite/PostgreSQL</text><path d="M1300.5522,602.8828 C1300.5522,592.8828 1318.5522,592.8828 1318.5522,592.8828 C1318.5522,592.8828 1336.5522,592.8828 1336.5522,602.8828 L1336.5522,628.8828 C1336.5522,638.8828 1318.5522,638.8828 1318.5522,638.8828 C1318.5522,638.8828 1300.5522,638.8828 1300.5522,628.8828 L1300.5522,602.8828" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1300.5522,602.8828 C1300.5522,612.8828 1318.5522,612.8828 1318.5522,612.8828 C1318.5522,612.8828 1336.5522,612.8828 1336.5522,602.8828" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="204.3608,145.7266,214.3608,149.7266,204.3608,153.7266,208.3608,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="56.3027" x2="210.3608" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.9292" x="63.3027" y="144.6606">fetch_signals()</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg2"><polygon fill="#181818" points="67.3027,174.8594,57.3027,178.8594,67.3027,182.8594,63.3027,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="61.3027" x2="215.3608" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.7568" x="73.3027" y="173.7935">list[ThreatSignal]</text></g><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg3"><polygon fill="#181818" points="369.4888,203.9922,379.4888,207.9922,369.4888,211.9922,373.4888,207.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="56.3027" x2="375.4888" y1="207.9922" y2="207.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3599" x="63.3027" y="202.9263">send_signals(signals)</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg4"><polygon fill="#181818" points="543.4077,233.125,553.4077,237.125,543.4077,241.125,547.4077,237.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="381.4888" x2="549.4077" y1="237.125" y2="237.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.5581" x="388.4888" y="232.0591">POST /api/v1/signals</text></g><g class="message" data-entity-1="part4" data-entity-2="part5" id="msg5"><polygon fill="#181818" points="724.8042,262.2578,734.8042,266.2578,724.8042,270.2578,728.8042,266.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="555.4077" x2="730.8042" y1="266.2578" y2="266.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3965" x="562.4077" y="261.1919">analyze_signals(signals)</text></g><path d="M659.4053,281.2578 L736.0293,281.2578 L736.0293,288.3906 L726.0293,298.3906 L659.4053,298.3906 L659.4053,281.2578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:1.5;" width="300.5347" x="659.4053" y="281.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="674.4053" y="294.3247">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80.3354" x="751.0293" y="293.4683">[each signal]</text><g class="message" data-entity-1="part5" data-entity-2="part6" id="msg6"><polygon fill="#181818" points="880.6514,315.5234,890.6514,319.5234,880.6514,323.5234,884.6514,319.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="736.8042" x2="886.6514" y1="319.5234" y2="319.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="743.8042" y="314.4575">build_finding(signal)</text></g><g class="message" data-entity-1="part6" data-entity-2="part5" id="msg7"><polygon fill="#181818" points="747.8042,344.6563,737.8042,348.6563,747.8042,352.6563,743.8042,348.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="741.8042" x2="891.6514" y1="348.6563" y2="348.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.0674" x="753.8042" y="343.5903">SecurityFinding</text></g><g class="message" data-entity-1="part5" data-entity-2="part4" id="msg8"><polygon fill="#181818" points="566.4077,380.7891,556.4077,384.7891,566.4077,388.7891,562.4077,384.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="560.4077" x2="735.8042" y1="384.7891" y2="384.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3047" x="572.4077" y="379.7231">list[SecurityFinding]</text></g><g class="message" data-entity-1="part4" data-entity-2="part7" id="msg9"><polygon fill="#181818" points="1043.4106,409.9219,1053.4106,413.9219,1043.4106,417.9219,1047.4106,413.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="555.4077" x2="1049.4106" y1="413.9219" y2="413.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.1694" x="562.4077" y="408.856">add(findings)</text></g><g class="message" data-entity-1="part7" data-entity-2="part8" id="msg10"><polygon fill="#181818" points="1306.5522,439.0547,1316.5522,443.0547,1306.5522,447.0547,1310.5522,443.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1055.4106" x2="1312.5522" y1="443.0547" y2="443.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.1416" x="1062.4106" y="437.9888">upsert resources/findings/references</text></g><g class="message" data-entity-1="part8" data-entity-2="part7" id="msg11"><polygon fill="#181818" points="1066.4106,468.1875,1056.4106,472.1875,1066.4106,476.1875,1062.4106,472.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1060.4106" x2="1317.5522" y1="472.1875" y2="472.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1372" x="1072.4106" y="467.1216">commit</text></g><g class="message" data-entity-1="part7" data-entity-2="part4" id="msg12"><polygon fill="#181818" points="566.4077,497.3203,556.4077,501.3203,566.4077,505.3203,562.4077,501.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="560.4077" x2="1054.4106" y1="501.3203" y2="501.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="572.4077" y="496.2544">ok</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg13"><polygon fill="#181818" points="392.4888,526.4531,382.4888,530.4531,392.4888,534.4531,388.4888,530.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="386.4888" x2="554.4077" y1="530.4531" y2="530.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9189" x="398.4888" y="525.3872">IngestSignalsResponse</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg14"><polygon fill="#181818" points="67.3027,555.5859,57.3027,559.5859,67.3027,563.5859,63.3027,559.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="61.3027" x2="380.4888" y1="559.5859" y2="559.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.8481" x="73.3027" y="554.52">{ ingested, findings }</text></g><?plantuml-src NPF1QkCm48RlUeeXfmPgJAyz54pPGc6NfbLkIocAD7547CdLo8LswRjt9DdUE2TBCz_yC_ebHnix1AcKXEqlsK05qhPETV3eMgHelGE9xmCwZK8e7Ns0LTEYY_0oE8TX1OeWvANeLOXMsrvnTlN7w-Fs45358hW9_iEQiQ0VDykID43Js_lEidxco1oNo8EYs6mUeLQzhJzkQihQb64EBM75gSylV1kXgtN1IdI9xWRRcRUzTSQwTWH9-t21oUVVJQSFUFfyAAXaGx3GQIMCYcgd23Dg8zORJx4DoBjCcPqGnIsexcORu1Rs6FNX_wHYJbNCZHMtq5cAVyzTVJsNOxUO8NHc5Xg_Qv5oZB17Z6oUvFRIGf5IYIZsC7LftwmbEkzxGAKFK682vh8qHlADwvUU5dBDQCbNYruIzH1id6mLV0P-RfFcF7W-_mNxEasURo3DRSpLs3KTF4SvRNQS6th2424W-I5ef7e2wu1x3EcPas2oEjFJ_dIoSHAQP_77qdWsllmnvLxe1QdtZh0OVtw7_y1c4CqrJDtXM_m0?></g></svg>